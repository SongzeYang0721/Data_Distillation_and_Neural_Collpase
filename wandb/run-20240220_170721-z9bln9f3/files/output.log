
--------------------- Evaluating -------------------------------
[epoch: 1] | collapsemetric: 2.3067 | ETF metric: 0.0000 | WH metric: 0.6353 | Wh_b metric: 0.8803
[epoch: 1] | train top1: 58.9660 | train top5: 95.4660 | test top1: 57.2800 | test top5: 95.1300
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 1] | train top1: 56.0000 | train top5: 93.0320 | test top1: 0.6900 | test top5: 4.8700
[epoch: 2] | collapsemetric: 1.3702 | ETF metric: 0.0000 | WH metric: 0.5205 | Wh_b metric: 0.9755
[epoch: 2] | train top1: 69.0780 | train top5: 97.0540 | test top1: 65.9700 | test top5: 96.2200
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 2] | train top1: 67.0260 | train top5: 96.2660 | test top1: 0.4300 | test top5: 3.7800
[epoch: 3] | collapsemetric: 1.0926 | ETF metric: 0.0000 | WH metric: 0.5295 | Wh_b metric: 0.8379
[epoch: 3] | train top1: 72.4120 | train top5: 97.5620 | test top1: 67.9400 | test top5: 96.6900
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 3] | train top1: 69.8840 | train top5: 97.3180 | test top1: 0.3300 | test top5: 3.3100
[epoch: 4] | collapsemetric: 0.8553 | ETF metric: 0.0000 | WH metric: 0.5290 | Wh_b metric: 0.8381
[epoch: 4] | train top1: 76.8640 | train top5: 98.4500 | test top1: 71.0500 | test top5: 97.4400
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 4] | train top1: 73.4680 | train top5: 97.9340 | test top1: 0.2100 | test top5: 2.5600
[epoch: 5] | collapsemetric: 0.7717 | ETF metric: 0.0000 | WH metric: 0.5535 | Wh_b metric: 1.0728
[epoch: 5] | train top1: 75.5900 | train top5: 98.5360 | test top1: 69.3800 | test top5: 97.4200
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 5] | train top1: 70.8820 | train top5: 98.0240 | test top1: 0.2800 | test top5: 2.5800
[epoch: 6] | collapsemetric: 0.6285 | ETF metric: 0.0000 | WH metric: 0.4902 | Wh_b metric: 0.9831
[epoch: 6] | train top1: 82.5600 | train top5: 99.0220 | test top1: 74.4700 | test top5: 97.8600
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 6] | train top1: 81.1520 | train top5: 98.4380 | test top1: 0.1900 | test top5: 2.1400
[epoch: 7] | collapsemetric: 0.5596 | ETF metric: 0.0000 | WH metric: 0.4747 | Wh_b metric: 0.9228
[epoch: 7] | train top1: 83.6200 | train top5: 99.2540 | test top1: 74.3700 | test top5: 97.9200
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 7] | train top1: 80.2260 | train top5: 98.7120 | test top1: 0.1900 | test top5: 2.0800
[epoch: 8] | collapsemetric: 0.4938 | ETF metric: 0.0000 | WH metric: 0.4790 | Wh_b metric: 0.8960
[epoch: 8] | train top1: 86.2360 | train top5: 99.4040 | test top1: 75.3400 | test top5: 98.2800
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 8] | train top1: 83.7800 | train top5: 99.1680 | test top1: 0.1600 | test top5: 1.7200
[epoch: 9] | collapsemetric: 0.4132 | ETF metric: 0.0000 | WH metric: 0.4095 | Wh_b metric: 0.5923
[epoch: 9] | train top1: 87.1440 | train top5: 99.5000 | test top1: 76.6100 | test top5: 98.0200
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 9] | train top1: 85.7380 | train top5: 99.2520 | test top1: 0.0900 | test top5: 1.9800
[epoch: 10] | collapsemetric: 0.4209 | ETF metric: 0.0000 | WH metric: 0.4414 | Wh_b metric: 0.7261
[epoch: 10] | train top1: 86.9460 | train top5: 99.4920 | test top1: 74.9000 | test top5: 97.8900
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 10] | train top1: 84.3260 | train top5: 99.3660 | test top1: 0.1400 | test top5: 2.1100
[epoch: 11] | collapsemetric: 0.3326 | ETF metric: 0.0000 | WH metric: 0.3743 | Wh_b metric: 0.7405
[epoch: 11] | train top1: 91.6080 | train top5: 99.7220 | test top1: 77.5700 | test top5: 98.1400
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 11] | train top1: 90.6240 | train top5: 99.6660 | test top1: 0.0800 | test top5: 1.8600
[epoch: 12] | collapsemetric: 0.3372 | ETF metric: 0.0000 | WH metric: 0.3742 | Wh_b metric: 0.8430
[epoch: 12] | train top1: 91.2980 | train top5: 99.7460 | test top1: 76.9000 | test top5: 98.0000
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 12] | train top1: 90.1420 | train top5: 99.6480 | test top1: 0.1400 | test top5: 2.0000
[epoch: 13] | collapsemetric: 0.3231 | ETF metric: 0.0000 | WH metric: 0.3589 | Wh_b metric: 0.5823
[epoch: 13] | train top1: 91.5840 | train top5: 99.7400 | test top1: 75.4300 | test top5: 97.8200
--------------------- nearest neighbor accuracy -------------------------------
[epoch: 13] | train top1: 90.2840 | train top5: 99.6460 | test top1: 0.1700 | test top5: 2.1800
Exception ignored in: <function _MultiProcessingDataLoaderIter.__del__ at 0x166403380>
Traceback (most recent call last):
  File "/Users/songzeyang/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1478, in __del__
    self._shutdown_workers()
  File "/Users/songzeyang/anaconda3/lib/python3.11/site-packages/torch/utils/data/dataloader.py", line 1442, in _shutdown_workers
    w.join(timeout=_utils.MP_STATUS_CHECK_INTERVAL)
  File "/Users/songzeyang/anaconda3/lib/python3.11/multiprocessing/process.py", line 149, in join
    res = self._popen.wait(timeout)
          ^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/songzeyang/anaconda3/lib/python3.11/multiprocessing/popen_fork.py", line 40, in wait
    if not wait([self.sentinel], timeout):
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/songzeyang/anaconda3/lib/python3.11/multiprocessing/connection.py", line 930, in wait
    ready = selector.select(timeout)
            ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/Users/songzeyang/anaconda3/lib/python3.11/selectors.py", line 415, in select
    fd_event_list = self._selector.poll(timeout)
                    ^^^^^^^^^^^^^^^^^^^^^^^^^^^^
KeyboardInterrupt:
--- Logging error ---
Traceback (most recent call last):
  File "/Users/songzeyang/anaconda3/lib/python3.11/logging/__init__.py", line 1114, in emit
    self.flush()
  File "/Users/songzeyang/anaconda3/lib/python3.11/logging/__init__.py", line 1094, in flush
    self.stream.flush()
OSError: [Errno 5] Input/output error
Call stack:
  File "/Users/songzeyang/anaconda3/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
  File "/Users/songzeyang/anaconda3/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
  File "/Users/songzeyang/anaconda3/lib/python3.11/site-packages/ipykernel/parentpoller.py", line 38, in run
    get_logger().warning("Parent appears to have exited, shutting down.")
Message: 'Parent appears to have exited, shutting down.'
