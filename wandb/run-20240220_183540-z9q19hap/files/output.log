
--------------------- Evaluating -------------------------------
[epoch: 1] | collapsemetric: 2.3067 | ETF metric: 0.0000 | WH metric: 0.6353 | Wh_b metric: 0.8803
[epoch: 1] | train top1: 58.9660 | train top5: 95.4660 | test top1: 57.2800 | test top5: 95.1300
[epoch: 1] | train top1: 56.0000 | train top5: 93.0320 | test top1: 55.0800 | test top5: 92.6700  (nearest neighbor accuracy)
[epoch: 2] | collapsemetric: 1.3702 | ETF metric: 0.0000 | WH metric: 0.5205 | Wh_b metric: 0.9755
[epoch: 2] | train top1: 69.0780 | train top5: 97.0540 | test top1: 65.9700 | test top5: 96.2200
[epoch: 2] | train top1: 67.0260 | train top5: 96.2660 | test top1: 63.7900 | test top5: 95.5200  (nearest neighbor accuracy)
[epoch: 3] | collapsemetric: 1.0926 | ETF metric: 0.0000 | WH metric: 0.5295 | Wh_b metric: 0.8379
[epoch: 3] | train top1: 72.4120 | train top5: 97.5620 | test top1: 67.9400 | test top5: 96.6900
[epoch: 3] | train top1: 69.8840 | train top5: 97.3180 | test top1: 65.8600 | test top5: 96.2800  (nearest neighbor accuracy)
[epoch: 4] | collapsemetric: 0.8553 | ETF metric: 0.0000 | WH metric: 0.5290 | Wh_b metric: 0.8381
[epoch: 4] | train top1: 76.8640 | train top5: 98.4500 | test top1: 71.0500 | test top5: 97.4400
[epoch: 4] | train top1: 73.4680 | train top5: 97.9340 | test top1: 68.0100 | test top5: 96.7900  (nearest neighbor accuracy)
[epoch: 5] | collapsemetric: 0.7717 | ETF metric: 0.0000 | WH metric: 0.5535 | Wh_b metric: 1.0728
[epoch: 5] | train top1: 75.5900 | train top5: 98.5360 | test top1: 69.3800 | test top5: 97.4200
[epoch: 5] | train top1: 70.8820 | train top5: 98.0240 | test top1: 64.9500 | test top5: 96.7300  (nearest neighbor accuracy)
[epoch: 6] | collapsemetric: 0.6285 | ETF metric: 0.0000 | WH metric: 0.4902 | Wh_b metric: 0.9831
[epoch: 6] | train top1: 82.5600 | train top5: 99.0220 | test top1: 74.4700 | test top5: 97.8600
[epoch: 6] | train top1: 81.1520 | train top5: 98.4380 | test top1: 73.3200 | test top5: 97.0500  (nearest neighbor accuracy)
[epoch: 7] | collapsemetric: 0.5596 | ETF metric: 0.0000 | WH metric: 0.4747 | Wh_b metric: 0.9228
[epoch: 7] | train top1: 83.6200 | train top5: 99.2540 | test top1: 74.3700 | test top5: 97.9200
[epoch: 7] | train top1: 80.2260 | train top5: 98.7120 | test top1: 71.5500 | test top5: 97.3000  (nearest neighbor accuracy)
[epoch: 8] | collapsemetric: 0.4938 | ETF metric: 0.0000 | WH metric: 0.4790 | Wh_b metric: 0.8960
[epoch: 8] | train top1: 86.2360 | train top5: 99.4040 | test top1: 75.3400 | test top5: 98.2800
[epoch: 8] | train top1: 83.7800 | train top5: 99.1680 | test top1: 73.3400 | test top5: 97.6300  (nearest neighbor accuracy)
[epoch: 9] | collapsemetric: 0.4132 | ETF metric: 0.0000 | WH metric: 0.4095 | Wh_b metric: 0.5923
[epoch: 9] | train top1: 87.1440 | train top5: 99.5000 | test top1: 76.6100 | test top5: 98.0200
[epoch: 9] | train top1: 85.7380 | train top5: 99.2520 | test top1: 75.9100 | test top5: 97.7000  (nearest neighbor accuracy)
[epoch: 10] | collapsemetric: 0.4209 | ETF metric: 0.0000 | WH metric: 0.4414 | Wh_b metric: 0.7261
[epoch: 10] | train top1: 86.9460 | train top5: 99.4920 | test top1: 74.9000 | test top5: 97.8900
[epoch: 10] | train top1: 84.3260 | train top5: 99.3660 | test top1: 73.2800 | test top5: 97.6600  (nearest neighbor accuracy)
[epoch: 11] | collapsemetric: 0.3326 | ETF metric: 0.0000 | WH metric: 0.3743 | Wh_b metric: 0.7405
[epoch: 11] | train top1: 91.6080 | train top5: 99.7220 | test top1: 77.5700 | test top5: 98.1400
[epoch: 11] | train top1: 90.6240 | train top5: 99.6660 | test top1: 76.8400 | test top5: 98.0800  (nearest neighbor accuracy)
[epoch: 12] | collapsemetric: 0.3372 | ETF metric: 0.0000 | WH metric: 0.3742 | Wh_b metric: 0.8430
[epoch: 12] | train top1: 91.2980 | train top5: 99.7460 | test top1: 76.9000 | test top5: 98.0000
[epoch: 12] | train top1: 90.1420 | train top5: 99.6480 | test top1: 75.9300 | test top5: 97.8200  (nearest neighbor accuracy)
[epoch: 13] | collapsemetric: 0.3231 | ETF metric: 0.0000 | WH metric: 0.3589 | Wh_b metric: 0.5823
[epoch: 13] | train top1: 91.5840 | train top5: 99.7400 | test top1: 75.4300 | test top5: 97.8200
[epoch: 13] | train top1: 90.2840 | train top5: 99.6460 | test top1: 74.9700 | test top5: 97.7600  (nearest neighbor accuracy)
[epoch: 14] | collapsemetric: 0.2858 | ETF metric: 0.0000 | WH metric: 0.3681 | Wh_b metric: 0.6535
[epoch: 14] | train top1: 93.4220 | train top5: 99.8160 | test top1: 76.5300 | test top5: 97.9600
[epoch: 14] | train top1: 92.6340 | train top5: 99.7360 | test top1: 76.2400 | test top5: 97.8300  (nearest neighbor accuracy)
[epoch: 15] | collapsemetric: 0.3189 | ETF metric: 0.0000 | WH metric: 0.3357 | Wh_b metric: 0.6421
[epoch: 15] | train top1: 91.1980 | train top5: 99.7440 | test top1: 74.8200 | test top5: 97.4900
[epoch: 15] | train top1: 90.6460 | train top5: 99.6780 | test top1: 74.4700 | test top5: 97.6100  (nearest neighbor accuracy)
[epoch: 16] | collapsemetric: 0.2801 | ETF metric: 0.0000 | WH metric: 0.3280 | Wh_b metric: 0.6499
[epoch: 16] | train top1: 93.2400 | train top5: 99.8620 | test top1: 76.3500 | test top5: 97.8400
[epoch: 16] | train top1: 92.3240 | train top5: 99.7360 | test top1: 75.8700 | test top5: 97.5500  (nearest neighbor accuracy)
[epoch: 17] | collapsemetric: 0.2538 | ETF metric: 0.0000 | WH metric: 0.3147 | Wh_b metric: 0.4831
[epoch: 17] | train top1: 94.1080 | train top5: 99.8800 | test top1: 76.4200 | test top5: 98.1100
[epoch: 17] | train top1: 93.8360 | train top5: 99.8480 | test top1: 75.9200 | test top5: 98.0500  (nearest neighbor accuracy)
[epoch: 18] | collapsemetric: 0.2776 | ETF metric: 0.0000 | WH metric: 0.2970 | Wh_b metric: 0.6620
[epoch: 18] | train top1: 92.8340 | train top5: 99.8340 | test top1: 74.9000 | test top5: 97.6400
[epoch: 18] | train top1: 92.4440 | train top5: 99.7720 | test top1: 74.6200 | test top5: 97.4000  (nearest neighbor accuracy)
[epoch: 19] | collapsemetric: 0.2678 | ETF metric: 0.0000 | WH metric: 0.3248 | Wh_b metric: 0.7022
[epoch: 19] | train top1: 93.6600 | train top5: 99.8920 | test top1: 75.2500 | test top5: 97.6800
[epoch: 19] | train top1: 92.7800 | train top5: 99.8420 | test top1: 74.8000 | test top5: 97.5000  (nearest neighbor accuracy)
[epoch: 20] | collapsemetric: 0.2486 | ETF metric: 0.0000 | WH metric: 0.3019 | Wh_b metric: 0.8396
[epoch: 20] | train top1: 94.9420 | train top5: 99.9040 | test top1: 75.4500 | test top5: 97.5700
[epoch: 20] | train top1: 94.1500 | train top5: 99.8180 | test top1: 75.1600 | test top5: 97.2800  (nearest neighbor accuracy)
[epoch: 21] | collapsemetric: 0.2613 | ETF metric: 0.0000 | WH metric: 0.2818 | Wh_b metric: 0.6318
[epoch: 21] | train top1: 94.5400 | train top5: 99.9200 | test top1: 75.7400 | test top5: 97.6600
[epoch: 21] | train top1: 93.9900 | train top5: 99.8780 | test top1: 75.4500 | test top5: 97.8200  (nearest neighbor accuracy)
[epoch: 22] | collapsemetric: 0.2651 | ETF metric: 0.0000 | WH metric: 0.3147 | Wh_b metric: 0.6904
[epoch: 22] | train top1: 93.8800 | train top5: 99.9120 | test top1: 74.7500 | test top5: 97.3700
[epoch: 22] | train top1: 93.0820 | train top5: 99.8240 | test top1: 74.5400 | test top5: 97.3000  (nearest neighbor accuracy)
[epoch: 23] | collapsemetric: 0.2322 | ETF metric: 0.0000 | WH metric: 0.2609 | Wh_b metric: 0.6842
[epoch: 23] | train top1: 95.5240 | train top5: 99.9180 | test top1: 76.6700 | test top5: 97.7600
[epoch: 23] | train top1: 95.0160 | train top5: 99.8960 | test top1: 76.1200 | test top5: 97.6000  (nearest neighbor accuracy)
[epoch: 24] | collapsemetric: 0.2435 | ETF metric: 0.0000 | WH metric: 0.2866 | Wh_b metric: 0.5026
[epoch: 24] | train top1: 94.2240 | train top5: 99.8960 | test top1: 75.6500 | test top5: 97.4500
[epoch: 24] | train top1: 93.7200 | train top5: 99.8320 | test top1: 75.2600 | test top5: 97.2400  (nearest neighbor accuracy)
[epoch: 25] | collapsemetric: 0.2366 | ETF metric: 0.0000 | WH metric: 0.2847 | Wh_b metric: 0.6508
[epoch: 25] | train top1: 95.6840 | train top5: 99.9260 | test top1: 75.8900 | test top5: 97.6500
[epoch: 25] | train top1: 94.9360 | train top5: 99.8760 | test top1: 75.3300 | test top5: 97.5700  (nearest neighbor accuracy)
[epoch: 26] | collapsemetric: 0.2404 | ETF metric: 0.0000 | WH metric: 0.2907 | Wh_b metric: 0.6548
[epoch: 26] | train top1: 94.9800 | train top5: 99.9320 | test top1: 75.3900 | test top5: 97.4400
[epoch: 26] | train top1: 94.1680 | train top5: 99.8800 | test top1: 75.0800 | test top5: 97.1900  (nearest neighbor accuracy)
[epoch: 27] | collapsemetric: 0.2362 | ETF metric: 0.0000 | WH metric: 0.2780 | Wh_b metric: 0.7345
[epoch: 27] | train top1: 94.7140 | train top5: 99.9440 | test top1: 75.3700 | test top5: 97.2100
[epoch: 27] | train top1: 93.8360 | train top5: 99.9300 | test top1: 74.5800 | test top5: 97.0900  (nearest neighbor accuracy)
[epoch: 28] | collapsemetric: 0.2407 | ETF metric: 0.0000 | WH metric: 0.2677 | Wh_b metric: 0.6403
[epoch: 28] | train top1: 95.3340 | train top5: 99.9460 | test top1: 75.7400 | test top5: 97.2100
[epoch: 28] | train top1: 94.5920 | train top5: 99.9060 | test top1: 75.0700 | test top5: 97.3500  (nearest neighbor accuracy)
[epoch: 29] | collapsemetric: 0.2174 | ETF metric: 0.0000 | WH metric: 0.2688 | Wh_b metric: 0.7079
[epoch: 29] | train top1: 96.4320 | train top5: 99.9640 | test top1: 76.8000 | test top5: 97.6400
[epoch: 29] | train top1: 95.7080 | train top5: 99.9120 | test top1: 75.9800 | test top5: 97.3300  (nearest neighbor accuracy)
[epoch: 30] | collapsemetric: 0.2385 | ETF metric: 0.0000 | WH metric: 0.2763 | Wh_b metric: 0.7884
[epoch: 30] | train top1: 95.2740 | train top5: 99.9420 | test top1: 75.6400 | test top5: 97.4400
[epoch: 30] | train top1: 94.7780 | train top5: 99.9220 | test top1: 75.0200 | test top5: 97.7600  (nearest neighbor accuracy)
[epoch: 31] | collapsemetric: 0.2173 | ETF metric: 0.0000 | WH metric: 0.2564 | Wh_b metric: 0.6979
[epoch: 31] | train top1: 96.2780 | train top5: 99.9560 | test top1: 76.3700 | test top5: 97.5900
[epoch: 31] | train top1: 95.9420 | train top5: 99.9200 | test top1: 76.0900 | test top5: 97.5900  (nearest neighbor accuracy)
[epoch: 32] | collapsemetric: 0.2325 | ETF metric: 0.0000 | WH metric: 0.2940 | Wh_b metric: 0.5857
[epoch: 32] | train top1: 95.6320 | train top5: 99.9440 | test top1: 75.7200 | test top5: 97.5400
[epoch: 32] | train top1: 94.6580 | train top5: 99.8960 | test top1: 75.0600 | test top5: 97.4700  (nearest neighbor accuracy)
[epoch: 33] | collapsemetric: 0.2195 | ETF metric: 0.0000 | WH metric: 0.2498 | Wh_b metric: 0.6243
[epoch: 33] | train top1: 95.6740 | train top5: 99.9580 | test top1: 75.6900 | test top5: 97.5200
[epoch: 33] | train top1: 95.0880 | train top5: 99.9560 | test top1: 75.1200 | test top5: 97.3900  (nearest neighbor accuracy)
[epoch: 34] | collapsemetric: 0.2231 | ETF metric: 0.0000 | WH metric: 0.2651 | Wh_b metric: 0.7169
[epoch: 34] | train top1: 95.4380 | train top5: 99.9640 | test top1: 75.8200 | test top5: 97.5600
[epoch: 34] | train top1: 94.8280 | train top5: 99.9040 | test top1: 75.5200 | test top5: 97.3700  (nearest neighbor accuracy)
[epoch: 35] | collapsemetric: 0.2236 | ETF metric: 0.0000 | WH metric: 0.2520 | Wh_b metric: 0.5805
[epoch: 35] | train top1: 95.8000 | train top5: 99.9560 | test top1: 75.2100 | test top5: 97.3700
[epoch: 35] | train top1: 95.3900 | train top5: 99.9240 | test top1: 74.5900 | test top5: 97.4800  (nearest neighbor accuracy)
[epoch: 36] | collapsemetric: 0.2042 | ETF metric: 0.0000 | WH metric: 0.2639 | Wh_b metric: 0.4694
[epoch: 36] | train top1: 96.7880 | train top5: 99.9620 | test top1: 76.9500 | test top5: 97.6500
[epoch: 36] | train top1: 96.4580 | train top5: 99.9400 | test top1: 76.5500 | test top5: 97.7000  (nearest neighbor accuracy)
[epoch: 37] | collapsemetric: 0.2214 | ETF metric: 0.0000 | WH metric: 0.2737 | Wh_b metric: 0.7709
[epoch: 37] | train top1: 95.8720 | train top5: 99.9580 | test top1: 75.2200 | test top5: 97.4300
[epoch: 37] | train top1: 94.7340 | train top5: 99.9440 | test top1: 74.4000 | test top5: 97.5300  (nearest neighbor accuracy)
[epoch: 38] | collapsemetric: 0.2108 | ETF metric: 0.0000 | WH metric: 0.2409 | Wh_b metric: 0.8248
[epoch: 38] | train top1: 96.2380 | train top5: 99.9660 | test top1: 75.7500 | test top5: 97.4700
[epoch: 38] | train top1: 95.2500 | train top5: 99.9500 | test top1: 74.6700 | test top5: 97.1300  (nearest neighbor accuracy)
[epoch: 39] | collapsemetric: 0.2206 | ETF metric: 0.0000 | WH metric: 0.2613 | Wh_b metric: 0.7302
[epoch: 39] | train top1: 95.3760 | train top5: 99.9640 | test top1: 75.7300 | test top5: 97.1800
[epoch: 39] | train top1: 94.7500 | train top5: 99.9240 | test top1: 75.0500 | test top5: 97.2500  (nearest neighbor accuracy)
[epoch: 40] | collapsemetric: 0.1987 | ETF metric: 0.0000 | WH metric: 0.2234 | Wh_b metric: 0.6696
[epoch: 40] | train top1: 96.4420 | train top5: 99.9380 | test top1: 76.4200 | test top5: 97.6700
[epoch: 40] | train top1: 96.2780 | train top5: 99.9420 | test top1: 76.4300 | test top5: 97.6500  (nearest neighbor accuracy)
[epoch: 41] | collapsemetric: 0.1199 | ETF metric: 0.0000 | WH metric: 0.1593 | Wh_b metric: 0.5474
[epoch: 41] | train top1: 99.7020 | train top5: 99.9840 | test top1: 78.3300 | test top5: 97.8500
[epoch: 41] | train top1: 99.6420 | train top5: 99.9860 | test top1: 78.2100 | test top5: 98.0100  (nearest neighbor accuracy)
[epoch: 42] | collapsemetric: 0.0940 | ETF metric: 0.0000 | WH metric: 0.1026 | Wh_b metric: 0.5960
[epoch: 42] | train top1: 99.9280 | train top5: 99.9860 | test top1: 78.7000 | test top5: 97.6800
[epoch: 42] | train top1: 99.9260 | train top5: 99.9880 | test top1: 78.6900 | test top5: 97.7000  (nearest neighbor accuracy)
[epoch: 43] | collapsemetric: 0.0797 | ETF metric: 0.0000 | WH metric: 0.0811 | Wh_b metric: 0.6303
[epoch: 43] | train top1: 99.9660 | train top5: 99.9860 | test top1: 78.6500 | test top5: 97.4700
[epoch: 43] | train top1: 99.9600 | train top5: 99.9860 | test top1: 78.5300 | test top5: 97.1600  (nearest neighbor accuracy)
[epoch: 44] | collapsemetric: 0.0704 | ETF metric: 0.0000 | WH metric: 0.0784 | Wh_b metric: 0.6152
[epoch: 44] | train top1: 99.9780 | train top5: 99.9880 | test top1: 78.4300 | test top5: 97.3900
[epoch: 44] | train top1: 99.9780 | train top5: 99.9900 | test top1: 78.4800 | test top5: 96.7700  (nearest neighbor accuracy)
[epoch: 45] | collapsemetric: 0.0589 | ETF metric: 0.0000 | WH metric: 0.0659 | Wh_b metric: 0.5880
[epoch: 45] | train top1: 99.9800 | train top5: 99.9880 | test top1: 78.4000 | test top5: 97.2700
[epoch: 45] | train top1: 99.9820 | train top5: 99.9880 | test top1: 78.3200 | test top5: 96.4000  (nearest neighbor accuracy)
[epoch: 46] | collapsemetric: 0.0549 | ETF metric: 0.0000 | WH metric: 0.0724 | Wh_b metric: 0.6082
[epoch: 46] | train top1: 99.9800 | train top5: 99.9900 | test top1: 78.4100 | test top5: 97.0800
[epoch: 46] | train top1: 99.9840 | train top5: 99.9880 | test top1: 78.5700 | test top5: 96.1400  (nearest neighbor accuracy)
--- Logging error ---
Traceback (most recent call last):
  File "/Users/songzeyang/anaconda3/lib/python3.11/logging/__init__.py", line 1114, in emit
    self.flush()
  File "/Users/songzeyang/anaconda3/lib/python3.11/logging/__init__.py", line 1094, in flush
    self.stream.flush()
OSError: [Errno 5] Input/output error
Call stack:
  File "/Users/songzeyang/anaconda3/lib/python3.11/threading.py", line 995, in _bootstrap
    self._bootstrap_inner()
  File "/Users/songzeyang/anaconda3/lib/python3.11/threading.py", line 1038, in _bootstrap_inner
    self.run()
  File "/Users/songzeyang/anaconda3/lib/python3.11/site-packages/ipykernel/parentpoller.py", line 38, in run
    get_logger().warning("Parent appears to have exited, shutting down.")
Message: 'Parent appears to have exited, shutting down.'
Arguments: ()